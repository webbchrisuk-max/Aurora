<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aurora Tracker ‚Äì Rebuild v1</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
<style>
:root {
  --cyan: #00ffff;
  --bg1: #050014;
  --bg2: #0e0030;
}
body {
  margin: 0;
  padding: 0;
  font-family: 'Orbitron', sans-serif;
  color: #fff;
  background: linear-gradient(135deg, var(--bg1), var(--bg2));
  background-size: 400% 400%;
  animation: auroraBG 35s ease-in-out infinite alternate;
}
@keyframes auroraBG {
  0% { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}
h1 {
  text-align: center;
  color: var(--cyan);
  text-shadow: 0 0 20px var(--cyan);
}
.card {
  background: rgba(0, 20, 40, 0.6);
  border: 1px solid rgba(0, 255, 255, 0.25);
  border-radius: 12px;
  box-shadow: 0 0 20px rgba(0, 255, 255, 0.15);
  padding: 20px;
  margin: 20px auto;
  max-width: 700px;
  backdrop-filter: blur(8px);
}
.value {
  color: var(--cyan);
}
.status {
  text-align: center;
  font-size: 0.9rem;
  color: #ccc;
}
</style>
</head>
<body>

<h1>üåå Aurora Tracker</h1>
<div id="status" class="status">Connecting to AuroraSync.json...</div>

<div class="card">
  <h2>Portfolio Summary</h2>
  <p>Total Target: ¬£<span id="targetValue">--</span></p>
  <p>Dividend Yield: <span id="divYield">--</span>%</p>
</div>

<div class="card">
  <h2>ISA Balances</h2>
  <p>IG ISA: ¬£<span id="igBalance">--</span></p>
  <p>Trade212 ISA: ¬£<span id="t212Balance">--</span></p>
</div>

<div class="card">
  <h2>IG ISA Holdings</h2>
  <table id="igTable" style="width:100%;border-collapse:collapse;">
    <thead><tr><th>Name</th><th>Value (¬£)</th><th>Gain (¬£)</th><th>Yield (%)</th></tr></thead>
    <tbody></tbody>
  </table>
</div>

<script>
const JSON_URL = "AuroraSync.json?ts=" + Date.now();

async function loadAurora() {
  const status = document.getElementById("status");
  try {
    const res = await fetch(JSON_URL, { cache: "no-store" });
    if (!res.ok) throw new Error("HTTP " + res.status);
    const data = await res.json();

    status.innerHTML = "‚úÖ Synced successfully at " + new Date().toLocaleTimeString();

    document.getElementById("targetValue").textContent =
      data?.isa?.portfolio_summary?.annual_target_value?.toFixed(2) ?? "--";
    document.getElementById("divYield").textContent =
      data?.isa?.portfolio_summary?.dividend_yield?.toFixed(2) ?? "--";
    document.getElementById("igBalance").textContent =
      data?.isa?.ig_isa?.balance?.toFixed(2) ?? "--";
    document.getElementById("t212Balance").textContent =
      data?.isa?.trade212_isa?.balance?.toFixed(2) ?? "--";

    const igTable = document.querySelector("#igTable tbody");
    igTable.innerHTML = "";
    (data?.isa_feed || []).filter(x => x.account === "IG ISA").forEach(h => {
      igTable.insertAdjacentHTML("beforeend",
        `<tr>
          <td>${h.name}</td>
          <td class="value">${(+h.value).toFixed(2)}</td>
          <td>${(+h.gain_value).toFixed(2)}</td>
          <td>${(+h.annual_div_yield).toFixed(2)}</td>
        </tr>`);
    });

  } catch (err) {
    console.error("‚ùå Fetch failed:", err);
    status.innerHTML = "‚ùå Failed to fetch data (" + err.message + ")";
  }
}

loadAurora();
</script>
</body>
</html>
