<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Aurora ISA Tracker â€“ Cinematic Edition</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />

<style>
:root{
  --cyan:#00eaff;
  --coral:#ff7f50;
  --teal:#00ffd0;
  --amber:#ffb347;
  --bg1:#060018;
  --bg2:#120035;
  --bg3:#001a33;

  --card-bg: rgba(255,255,255,0.06);
  --card-border: rgba(255,255,255,0.15);
}

body{
  margin:0;padding:0;
  font-family:'Orbitron',sans-serif;
  background:linear-gradient(120deg,var(--bg1),var(--bg2),var(--bg3));
  background-size:600% 600%;
  animation:auroraDrift 40s ease-in-out infinite;
  color:#fff;
}

@keyframes auroraDrift{
  0%{background-position:0% 50%;}
  50%{background-position:100% 50%;}
  100%{background-position:0% 50%;}
}

.container{
  padding:20px;
  max-width:1100px;
  margin:auto;
}

.section-title{
  font-size:22px;
  font-weight:700;
  color:var(--cyan);
  margin-top:35px;
  text-align:center;
  text-shadow:0 0 10px var(--cyan);
}

/* ===================== CAROUSEL ===================== */
.carousel{
  display:flex;
  overflow-x:auto;
  scroll-snap-type:x mandatory;
  gap:20px;
  padding:20px 10px;
  -webkit-overflow-scrolling:touch;
}

.carousel-card{
  flex:0 0 85%;
  scroll-snap-align:center;
  background:var(--card-bg);
  border:1px solid var(--card-border);
  border-radius:16px;
  padding:18px;
  backdrop-filter:blur(8px);
  box-shadow:0 0 15px rgba(0,255,255,0.25);
  text-align:center;
  transition:0.3s;
}
.carousel-card:hover{
  transform:scale(1.03);
}

.table{
  width:100%;
  border-collapse:collapse;
}
.table th{
  padding:8px;
  background:rgba(0,200,255,0.3);
  border-bottom:1px solid var(--cyan);
}
.table td{
  padding:8px;
  border-bottom:1px solid rgba(255,255,255,0.1);
}

.card{
  background:var(--card-bg);
  border:1px solid var(--card-border);
  border-radius:16px;
  padding:18px;
  margin-bottom:20px;
  backdrop-filter:blur(8px);
  box-shadow:0 0 15px rgba(0,255,255,0.25);
}

.dividend-item{
  padding:10px 12px;
  background:rgba(255,255,255,0.07);
  border:1px solid rgba(255,255,255,0.15);
  border-radius:12px;
  margin-bottom:10px;
  font-size:14px;
}

</style>

<script>
const AURORA_SYNC =
  "https://raw.githubusercontent.com/webbchrisuk-max/Aurora/refs/heads/main/AuroraSync.json";

async function loadJSON(url){
  const r = await fetch(url+"?nocache="+Date.now());
  return await r.json();
}

async function initAurora(){
  const sync = await loadJSON(AURORA_SYNC);

  renderPortfolio(sync);
  renderWatchlist(sync);
  renderIG(sync);
  renderT212(sync);
  renderTesco(sync);
  renderReits(sync);
  renderFinancials(sync);
  renderNextFive(sync);
  renderUpcoming(sync);
  renderYTD(sync);
  renderChart(sync);
}
</script>
</head>

<body onload="initAurora()">

<div class="container">

<h1 class="section-title">ðŸŒŒ Aurora ISA Tracker â€“ Cinematic Edition</h1>

<!-- ===================== PORTFOLIO SUMMARY ===================== -->
<div class="card">
  <h2 class="section-title">Portfolio Summary</h2>
  <div id="portfolio-summary"></div>
</div>

<!-- ===================== WATCHLIST ===================== -->
<div class="card">
  <h2 class="section-title">Watchlist Summary</h2>
  <div id="watchlist-summary"></div>
</div>

<!-- ===================== IG CAROUSEL ===================== -->
<div class="card">
  <h2 class="section-title">IG ISA Holdings</h2>
  <div class="carousel" id="ig-carousel"></div>
</div>

<!-- ===================== T212 CAROUSEL ===================== -->
<div class="card">
  <h2 class="section-title">Trade212 ISA Holdings</h2>
  <div class="carousel" id="t212-carousel"></div>
</div>

<!-- ===================== TESCO SIP + SAYE ===================== -->
<div class="card">
  <h2 class="section-title">Tesco Share Plan</h2>
  <div id="tesco-cards"></div>
</div>

<!-- ===================== REITS OUTLOOK ===================== -->
<div class="card">
  <h2 class="section-title">REITs Outlook</h2>
  <div id="reits-out"></div>
</div>

<!-- ===================== FINANCIALS OUTLOOK ===================== -->
<div class="card">
  <h2 class="section-title">Financials Outlook</h2>
  <div id="fin-out"></div>
</div>

<!-- ===================== NEXT FIVE ===================== -->
<div class="card">
  <h2 class="section-title">Next 5 Dividends</h2>
  <div id="next5"></div>
</div>

<!-- ===================== UPCOMING ===================== -->
<div class="card">
  <h2 class="section-title">Upcoming Dividends</h2>
  <div id="upcoming"></div>
</div>

<!-- ===================== CHART ===================== -->
<div class="card">
  <h2 class="section-title">12-Month Dividend Forecast</h2>
  <canvas id="divChart"></canvas>
</div>

<!-- ===================== YTD ===================== -->
<div class="card">
  <h2 class="section-title">Year-To-Date Income</h2>
  <div id="ytd"></div>
</div>

</div>

<script>

/* ===== PORTFOLIO ===== */
function renderPortfolio(sync){
  const ig = sync?.isa?.ig_isa?.balance || 0;
  const t = sync?.isa?.trade212_isa?.balance || 0;
  const total = sync?.isa?.portfolio_summary?.total_value || 0;
  const income = sync?.isa?.portfolio_summary?.annual_income_gbp || 0;

  document.getElementById("portfolio-summary").innerHTML = `
    <p><strong>IG ISA:</strong> Â£${ig.toFixed(2)}</p>
    <p><strong>Trade212 ISA:</strong> Â£${t.toFixed(2)}</p>
    <p><strong>Total Portfolio:</strong> Â£${total.toFixed(2)}</p>
    <p><strong>Annual Income:</strong> Â£${income.toFixed(2)}</p>
  `;
}

/* ===== WATCHLIST ===== */
function renderWatchlist(sync){
  const w = sync?.watchlist || [];
  if(!w.length){
    document.getElementById("watchlist-summary").innerHTML="<p>No watchlist data.</p>";
    return;
  }

  const top = [...w]
    .sort((a,b)=>b.discount_percentage - a.discount_percentage)
    .slice(0,5);

  let html=``;
  top.forEach(s=>{
    html+=`
      <div class="dividend-item">
        <strong>${s.ticker}</strong> â€“ ${s.company}<br>
        Discount: ${s.discount_percentage}%<br>
        Status: ${s.status}
      </div>
    `;
  });

  document.getElementById("watchlist-summary").innerHTML=html;
}

/* ===== IG CAROUSEL ===== */
function renderIG(sync){
  const ig = sync?.isa?.holdings?.ig_isa || [];
  const box = document.getElementById("ig-carousel");

  ig.forEach(h=>{
    box.innerHTML += `
      <div class="carousel-card">
        <h3>${h.ticker}</h3>
        <p>${h.name}</p>
        <p>Shares: ${h.shares}</p>
        <p>Value: Â£${h.value.toFixed(2)}</p>
        <p>Gain: <span style="color:${h.gain_value>=0?"lime":"red"}">
          Â£${h.gain_value.toFixed(2)}</span>
        </p>
      </div>
    `;
  });
}

/* ===== T212 CAROUSEL ===== */
function renderT212(sync){
  const t = sync?.isa?.holdings?.trade212_isa || [];
  const box = document.getElementById("t212-carousel");

  t.forEach(h=>{
    box.innerHTML += `
      <div class="carousel-card">
        <h3>${h.ticker}</h3>
        <p>${h.name}</p>
        <p>Shares: ${h.shares}</p>
        <p>Value: Â£${h.value.toFixed(2)}</p>
        <p>Gain: <span style="color:${h.gain_value>=0?"lime":"red"}">
          Â£${h.gain_value.toFixed(2)}</span>
        </p>
      </div>
    `;
  });
}

/* ===== TESCO ===== */
function renderTesco(sync){
  const t = sync?.tesco?.summary;
  if(!t){
    document.getElementById("tesco-cards").innerHTML="<p>No Tesco data found.</p>";
    return;
  }

  document.getElementById("tesco-cards").innerHTML = `
    <div class="carousel-card">
      <h3>ðŸ“¦ SIP Plan</h3>
      <p>Total Shares: ${t.sip_total_shares}</p>
      <p>Value: Â£${t.sip_value_gbp.toFixed(2)}</p>
      <p>Gain: Â£${t.sip_gain_gbp.toFixed(2)}</p>
    </div>

    <div class="carousel-card">
      <h3>ðŸ’¼ SAYE Plan</h3>
      <p>Total Options: ${t.saye_total_options}</p>
      <p>Option Price: Â£${t.saye_option_price}</p>
      <p>Value: Â£${t.saye_current_value_gbp.toFixed(2)}</p>
      <p>Gain: Â£${t.saye_potential_gain_gbp.toFixed(2)}</p>
    </div>
  `;
}

/* ===== REITS ===== */
function renderReits(sync){
  const r = sync?.reits_outlook || {};
  let html=``;
  Object.entries(r).forEach(([ticker,obj])=>{
    html+=`
      <div class="dividend-item">
        <strong>${ticker}</strong><br>
        Status: ${obj.status}<br>
        ${obj.notes}
      </div>
    `;
  });
  document.getElementById("reits-out").innerHTML=html;
}

/* ===== FINANCIALS ===== */
function renderFinancials(sync){
  const f = sync?.financials_outlook || {};
  let html=``;
  Object.entries(f).forEach(([ticker,obj])=>{
    html+=`
      <div class="dividend-item">
        <strong>${ticker}</strong><br>
        Status: ${obj.status}<br>
        ${obj.notes}
      </div>
    `;
  });
  document.getElementById("fin-out").innerHTML=html;
}

/* ===== NEXT FIVE ===== */
function renderNextFive(sync){
  const list = sync?.isa?.dividends?.next_five || [];
  let html="";
  list.forEach(d=>{
    html+=`
      <div class="dividend-item">
        <strong>${d.ticker}</strong><br>
        Ex: ${d.ex_div_date}<br>
        Pay: ${d.pay_date}<br>
        Â£${d.total_dividend.toFixed(2)}
      </div>
    `;
  });
  document.getElementById("next5").innerHTML=html;
}

/* ===== UPCOMING ===== */
function renderUpcoming(sync){
  const all = sync?.isa?.dividends?.upcoming || [];
  const today = new Date();

  const fut = all.filter(d=>new Date(d.ex_div_date)>=today)
                 .sort((a,b)=>new Date(a.ex_div_date)-new Date(b.ex_div_date))
                 .slice(0,5);

  let html="";
  fut.forEach(d=>{
    html+=`
      <div class="dividend-item">
        <strong>${d.ticker}</strong> â€“ ${d.name}<br>
        Ex: ${d.ex_div_date}<br>
        Pay: ${d.pay_date}<br>
        Status: ${d.status}<br>
        Â£${d.total_dividend.toFixed(2)}
      </div>
    `;
  });
  document.getElementById("upcoming").innerHTML=html;
}

/* ===== YTD ===== */
function renderYTD(sync){
  const totals = sync?.isa?.dividends?.monthly_totals || {};
  const year = new Date().getFullYear();
  let sum=0;
  Object.entries(totals).forEach(([m,val])=>{
    if(m.startsWith(year)) sum+=val;
  });
  document.getElementById("ytd").innerHTML=`<h2>Â£${sum.toFixed(2)}</h2>`;
}

/* ===== CHART ===== */
function renderChart(sync){
  const totals = sync?.isa?.dividends?.monthly_totals;
  if(!totals) return;

  const labels = Object.keys(totals);
  const values = labels.map(k=>totals[k]);

  const ctx=document.getElementById("divChart").getContext("2d");
  new Chart(ctx,{
    type:"bar",
    data:{labels,datasets:[{data:values,borderWidth:1}]},
    options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
  });
}

</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
