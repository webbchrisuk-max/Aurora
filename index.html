<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Aurora Tracker – HyperGrid Live Feed v2 (Pulse Edition)</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

<!-- ===================== SECTION: CORE THEME ===================== -->
<style>
body {
  margin:0;
  padding:0;
  font-family:'Orbitron',sans-serif;
  color:#fff;
  background-color:#030012;
  background-image:
    linear-gradient(90deg,rgba(255,0,255,0.05) 1px,transparent 1px),
    linear-gradient(rgba(0,255,255,0.05) 1px,transparent 1px);
  background-size:40px 40px;
  animation:scrollGrid 60s linear infinite;
  overflow-x:hidden;
}
@keyframes scrollGrid {
  from{background-position:0 0,0 0;}
  to{background-position:400px 400px,400px 400px;}
}

/* ===================== SECTION: HEADINGS & GRID ===================== */
h1{
  text-align:center;
  font-size:1.8rem;
  margin:20px 0;
  color:#00ffff;
  text-shadow:0 0 15px #00ffff;
}
.dashboard{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(480px,1fr));
  gap:20px;
  margin:0 5%;
}
.card{
  background:rgba(10,10,30,0.65);
  border:1px solid rgba(0,255,255,0.25);
  border-radius:10px;
  padding:20px;
  box-shadow:0 0 20px rgba(0,255,255,0.15);
  backdrop-filter:blur(6px);
  animation:fadeIn 1s ease-in-out;
}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}

/* ===================== SECTION: TABLES ===================== */
.table-holder{overflow-x:auto;max-height:350px;}
table{width:100%;border-collapse:collapse;font-size:0.9rem;}
th,td{padding:6px 8px;text-align:left;}
th{color:#ff66cc;}
tr:nth-child(even){background:rgba(255,255,255,0.05);}
tr:hover{background:rgba(0,255,255,0.1);}
.value{color:#00ffff;}
.gain-pos{color:#00ff99;}
.gain-neg{color:#ff6666;}

/* ===================== SECTION: SYNC STATUS ===================== */
#auroraSyncStatus{
  position:fixed;
  top:10px;
  right:20px;
  font-size:0.85rem;
  color:#fff;
}
#auroraSyncDot{
  display:inline-block;
  width:10px;
  height:10px;
  border-radius:50%;
  background:#00ffcc;
  box-shadow:0 0 10px #00ffcc;
  margin-right:6px;
  vertical-align:middle;
  animation:pulseGlow 3s ease-in-out infinite;
}
@keyframes pulseGlow{
  0%,100%{box-shadow:0 0 10px #00ffcc;}
  50%{box-shadow:0 0 25px #00ffff;}
}

// Quarterly Bars (stacked labels directly under bars)
const qData=data.dividend_planner.quarterly_breakdown;
const qBars=document.getElementById("quarterlyBars");
qBars.innerHTML="";
const maxVal=Math.max(...Object.values(qData));
Object.entries(qData).forEach(([q,v])=>{
  const wrapper=document.createElement("div");
  wrapper.style.display="flex";
  wrapper.style.flexDirection="column";
  wrapper.style.alignItems="center";

  const bar=document.createElement("div");
  bar.className="qbar";
  bar.style.height=(v/maxVal*180)+"px";
  wrapper.appendChild(bar);

  const label=document.createElement("div");
  label.className="qbar-label";
  label.innerHTML=`${q}<br>£${v.toFixed(2)}`;
  wrapper.appendChild(label);

  qBars.appendChild(wrapper);
});

  <!-- ===================== SECTION: Portfolio Summary ===================== -->
  <div class="card" id="portfolio-summary">
    <h2>Portfolio Summary</h2>
    <p>Total Target: £<span id="targetValue">0.00</span></p>
    <p>Dividend Yield: <span id="divYield">0.00</span>%</p>
  </div>

  <!-- ===================== SECTION: ISA Balances ===================== -->
  <div class="card" id="isa-balances">
    <h2>ISA Balances</h2>
    <p>IG ISA: £<span id="igBalance">0.00</span></p>
    <p>Trade212 ISA: £<span id="t212Balance">0.00</span></p>
  </div>

  <!-- ===================== SECTION: IG ISA Holdings ===================== -->
  <div class="card" id="ig-holdings">
    <h2>IG ISA Holdings</h2>
    <div class="table-holder">
      <table id="igTable">
        <thead>
          <tr>
            <th>Name</th>
            <th>Value (£)</th>
            <th>Gain (£)</th>
            <th>Gain (%)</th>
            <th>Yield (%)</th>
            <th>Income (£)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- ===================== SECTION: Trade212 Holdings ===================== -->
  <div class="card" id="t212-holdings">
    <h2>Trade212 Holdings</h2>
    <div class="table-holder">
      <table id="t212Table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Value (£)</th>
            <th>Gain (£)</th>
            <th>Gain (%)</th>
            <th>Yield (%)</th>
            <th>Income (£)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- ===================== SECTION: Dividends ===================== -->
  <div class="card" id="dividends">
    <h2>Next 5 Dividends</h2>
    <ul id="nextDivs"></ul>
    <h2>Next 5 Ex-Dividends</h2>
    <ul id="nextExDivs"></ul>
  </div>

  <!-- ===================== SECTION: Quarterly Dividend Breakdown ===================== -->
  <div class="card" id="quarterly">
    <h2>Quarterly Dividend Breakdown</h2>
    <div id="quarterlyBars"></div>
    <div id="quarterLabels"></div>
  </div>

</div>
<!-- ===================== SECTION: SCRIPT ===================== -->
<script>
async function loadAuroraSync(){
  const STATUS=document.getElementById("auroraSyncStatus");
  const url="https://cdn.jsdelivr.net/gh/webbchrisuk-max/Aurora@main/AuroraSync.json?nocache="+Date.now();

  try{
    const response=await fetch(url,{cache:"no-store"});
    if(!response.ok) throw new Error("HTTP "+response.status);
    const data=await response.json();
    window.AuroraSync=data;
    renderData(data);
  }catch(err){
    STATUS.innerHTML='<span id="auroraSyncDot" style="background:#ff4444;box-shadow:0 0 20px #ff4444;"></span>Sync Error';
    console.error("AuroraSync load error:",err);
  }
}

/* ===================== SECTION: RENDERING ===================== */
function renderData(data){
  // Portfolio Summary
  document.getElementById("targetValue").textContent=data.isa.portfolio_summary.annual_target_value.toFixed(2);
  document.getElementById("divYield").textContent=data.isa.portfolio_summary.dividend_yield.toFixed(2);

  // ISA Balances
  document.getElementById("igBalance").textContent=data.isa.ig_isa.balance.toFixed(2);
  document.getElementById("t212Balance").textContent=data.isa.trade212_isa.balance.toFixed(2);

  // IG Holdings
  const igBody=document.querySelector("#igTable tbody");
  igBody.innerHTML="";
  data.isa_feed.filter(x=>x.account==="IG ISA").forEach(h=>{
    const row=document.createElement("tr");
    row.innerHTML=`<td>${h.name}</td>
      <td class="value">${(+h.value).toFixed(2)}</td>
      <td class="${h.gain_value>=0?'gain-pos':'gain-neg'}">${(+h.gain_value).toFixed(2)}</td>
      <td class="${h.gain_value>=0?'gain-pos':'gain-neg'}">${(+h.gain_percentage).toFixed(2)}%</td>
      <td>${(+h.annual_div_yield).toFixed(2)}%</td>
      <td>${(+h.annual_income).toFixed(2)}</td>`;
    igBody.appendChild(row);
  });

  // Trade212 Holdings
  const tBody=document.querySelector("#t212Table tbody");
  tBody.innerHTML="";
  data.isa_feed.filter(x=>x.account==="TRADE212").forEach(h=>{
    const row=document.createElement("tr");
    row.innerHTML=`<td>${h.name}</td>
      <td class="value">${(+h.value).toFixed(2)}</td>
      <td class="${h.gain_value>=0?'gain-pos':'gain-neg'}">${(+h.gain_value).toFixed(2)}</td>
      <td class="${h.gain_value>=0?'gain-pos':'gain-neg'}">${(+h.gain_percentage).toFixed(2)}%</td>
      <td>${(+h.annual_div_yield).toFixed(2)}%</td>
      <td>${(+h.annual_income).toFixed(2)}</td>`;
    tBody.appendChild(row);
  });

  // Dividends
  const now=new Date();
  const upcoming=data.dividends_feed.filter(d=>new Date(d.pay_date)>now)
    .sort((a,b)=>new Date(a.pay_date)-new Date(b.pay_date))
    .slice(0,5);
  const upcomingEx=data.dividends_feed.filter(d=>new Date(d.ex_div_date)>now)
    .sort((a,b)=>new Date(a.ex_div_date)-new Date(b.ex_div_date))
    .slice(0,5);
  const nextDivs=document.getElementById("nextDivs");
  const nextExDivs=document.getElementById("nextExDivs");
  nextDivs.innerHTML="";
  nextExDivs.innerHTML="";
  upcoming.forEach(d=>{
    const li=document.createElement("li");
    li.textContent=`${d.name} – £${(+d.total_dividend).toFixed(2)} on ${d.pay_date}`;
    nextDivs.appendChild(li);
  });
  upcomingEx.forEach(d=>{
    const li=document.createElement("li");
    li.textContent=`${d.name} – Ex-Div ${d.ex_div_date}`;
    nextExDivs.appendChild(li);
  });

  // Quarterly Bars
  const qData=data.dividend_planner.quarterly_breakdown;
  const qBars=document.getElementById("quarterlyBars");
  const qLabels=document.getElementById("quarterLabels");
  qBars.innerHTML="";
  qLabels.innerHTML="";
  const maxVal=Math.max(...Object.values(qData));
  Object.entries(qData).forEach(([q,v])=>{
    const bar=document.createElement("div");
    bar.className="qbar";
    bar.style.height=(v/maxVal*200)+"px";
    qBars.appendChild(bar);
    const label=document.createElement("div");
    label.className="qbar-label";
    label.innerHTML=`${q}<br>£${v.toFixed(2)}`;
    qLabels.appendChild(label);
  });
}

/* ===================== SECTION: INIT ===================== */
loadAuroraSync();
setInterval(loadAuroraSync,300000); // every 5 minutes
</script>
</body>
</html>   
   
