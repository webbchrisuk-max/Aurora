<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aurora ISA Hub â€“ PulseFlow Edition</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&family=Inter:wght@300;500&display=swap" rel="stylesheet">

<!-- ===================== SECTION: CORE STYLES ===================== -->
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:"Inter",sans-serif;
  color:#fff;
  overflow-x:hidden;
  min-height:100vh;
  margin:0;
  position:relative;
}

/* Fixed animated background layer */
body::before{
  content:"";
  position:fixed;
  top:0;left:0;right:0;bottom:0;
  z-index:-1;
  background:radial-gradient(circle at top right,#070015 0%,#0b0220 70%);
  animation:bgPulse 14s ease-in-out infinite alternate;
  background-attachment:fixed;
  will-change:background;
}

@keyframes bgPulse{
  0%{background:radial-gradient(circle at top right,#070015 0%,#0b0220 70%);}
  100%{background:radial-gradient(circle at bottom left,#150040 0%,#000010 80%);}
}

h1,h2,h3{
  font-family:"Orbitron",sans-serif;
  letter-spacing:1px;
  text-transform:uppercase;
}
.container{
  width:95%;
  max-width:1200px;
  margin:auto;
  padding-top:70px;
}

/* Loading Screen */
#loadingScreen{
  position:fixed;
  top:0;left:0;width:100%;height:100%;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  background:radial-gradient(circle,#080020 0%,#000010 90%);
  z-index:9999;
}
.loader{
  width:80px;height:80px;border:6px solid rgba(0,255,200,0.2);
  border-top-color:#00ffcc;border-radius:50%;
  animation:spin 1.8s linear infinite;
  margin-bottom:20px;
}
@keyframes spin{to{transform:rotate(360deg);}}
#loadingText{font-family:"Orbitron";color:#00ffcc;font-size:1.2rem;}

/* Panels and Cards */
.section{
  margin-bottom:40px;
  background:rgba(255,255,255,0.04);
  border-radius:12px;
  padding:20px;
  box-shadow:0 0 20px rgba(0,255,200,0.15);
  backdrop-filter:blur(8px);
}
.section h2{color:#00ffcc;margin-bottom:12px;}
.flex{display:flex;flex-wrap:wrap;gap:20px;}
.card{
  flex:1 1 48%;
  background:rgba(0,0,0,0.4);
  border:1px solid rgba(255,255,255,0.08);
  border-radius:10px;
  padding:15px;
  box-shadow:0 0 15px rgba(255,127,80,0.15);
}
.card h3{color:#ff7f50;margin-bottom:8px;}
.value{font-size:1.3rem;font-weight:600;}
.glowText{color:#00ffcc;text-shadow:0 0 10px #00ffcc;}
.gain{color:#ff7f50;}

/* Sector Bars */
.barContainer{margin-top:10px;}
.bar{
  height:18px;
  background:linear-gradient(90deg,#00ffcc,#ff7f50);
  border-radius:10px;
  box-shadow:0 0 10px #00ffcc;
  margin-bottom:6px;
  transition:width 1.8s ease-out;
}

/* Dividend Bars */
.dividendBar{
  height:16px;
  background:linear-gradient(90deg,#ff7f50,#00ffcc);
  border-radius:10px;
  box-shadow:0 0 8px #ff7f50;
  margin-bottom:5px;
  transition:width 2s ease-out;
}

/* Footer Pulse Line */
#footerPulse{
  position:fixed;bottom:0;left:0;width:100%;height:3px;
  background:linear-gradient(90deg,#00ffcc,#ff7f50,#00ffcc);
  background-size:300% 100%;
  animation:pulseLine 6s linear infinite;
}
@keyframes pulseLine{
  0%{background-position:0% 50%;}
  100%{background-position:100% 50%;}
}

/* Responsive */
@media(max-width:768px){.card{flex:1 1 100%;}}
</style>
</head>

<body>
<!-- ===================== SECTION: LOADING ===================== -->
<div id="loadingScreen">
  <div class="loader"></div>
  <div id="loadingText">Loading Aurora ISA Hubâ€¦</div>
</div>

<div class="container" style="display:none;" id="mainContent">

<!-- ===================== SECTION: PORTFOLIO SUMMARY ===================== -->
<div class="section" id="summary">
  <h1>Aurora ISA Hub</h1>
  <p class="glowText">Combined Portfolio Overview</p>
  <p>Total Value: <span id="totalValue" class="value glowText">Â£XX,XXX.XX</span></p>
  <p>Book Cost: <span id="bookCost" class="value">Â£XX,XXX.XX</span></p>
  <p>Unrealised Gain: <span id="gainValue" class="value gain">Â£X,XXX.XX (+X.X%)</span></p>
  <p>Dividend Yield: <span id="divYield" class="value">X.X%</span></p>
</div>

<!-- ===================== SECTION: SECTOR ALLOCATION ===================== -->
<div class="section" id="sectors">
  <h2>Sector Allocation</h2>
  <div id="sectorBars"></div>
</div>

<!-- ===================== SECTION: ACCOUNT CARDS ===================== -->
<div class="section">
  <h2>Accounts</h2>
  <div class="flex">
    <div class="card">
      <h3>IG ISA</h3>
      <p>Balance: <span id="igValue" class="value">Â£XX,XXX.XX</span></p>
      <p>Gain: <span id="igGain" class="gain">+X.X%</span></p>
    </div>
    <div class="card">
      <h3>Trade212 ISA</h3>
      <p>Balance: <span id="t212Value" class="value">Â£X,XXX.XX</span></p>
      <p>Gain: <span id="t212Gain" class="gain">+X.X%</span></p>
    </div>
  </div>
</div>

<!-- ===================== SECTION: DIVIDEND OVERVIEW ===================== -->
<div class="section" id="dividends">
  <h2>Dividend Forecast</h2>
  <div id="dividendBars"></div>
</div>

<!-- ===================== SECTION: UPCOMING DIVIDENDS ===================== -->
<div class="section">
  <h2>Upcoming Dividends</h2>
  <ul id="upcomingList" style="list-style:none;"></ul>
</div>

</div>

<!-- ===================== SECTION: FOOTER PULSE ===================== -->
<div id="footerPulse"></div>

<!-- ===================== SECTION: SCRIPT ===================== -->
<script>
async function loadData(){
  const res = await fetch("https://raw.githubusercontent.com/webbchrisuk-max/Aurora/refs/heads/main/AuroraSync.json?nocache=" + Date.now());
  const data = await res.json();
  const ig = data.isa.ig_isa;
  const t212 = data.isa.trade212_isa;
  const port = data.isa.portfolio_summary;

  // Combined summary
  document.getElementById("totalValue").innerText = "Â£" + (ig.balance + t212.balance).toLocaleString();
  document.getElementById("bookCost").innerText = "Â£" + (ig.book_cost + t212.book_cost).toLocaleString();
  const totalGain = ((ig.unrealised_gain + t212.unrealised_gain) || 0).toFixed(2);
  document.getElementById("gainValue").innerText = "Â£" + totalGain + " (+" + port.gain_percent + "%)";
  document.getElementById("divYield").innerText = port.dividend_yield + "%";

  // Individual cards
  document.getElementById("igValue").innerText = "Â£" + ig.balance.toLocaleString();
  document.getElementById("igGain").innerText = "+" + ig.gain_percent + "%";
  document.getElementById("t212Value").innerText = "Â£" + t212.balance.toLocaleString();
  document.getElementById("t212Gain").innerText = "+" + t212.gain_percent + "%";

  // Sector Bars
  const sectors = port.sector_allocation;
  const sContainer = document.getElementById("sectorBars");
  for(let key in sectors){
    const wrap=document.createElement("div");
    wrap.innerHTML=`<p>${key} - ${sectors[key]}%</p><div class='bar' style='width:${sectors[key]}%;'></div>`;
    sContainer.appendChild(wrap);
  }

  // Dividend Bars (monthly_breakdown)
  const divContainer=document.getElementById("dividendBars");
  if(data.dividend_planner && data.dividend_planner.monthly_breakdown){
    data.dividend_planner.monthly_breakdown.forEach(m=>{
      const b=document.createElement("div");
      b.className="dividendBar";
      b.style.width=(Math.min(m.total_estimated_income/50,100))+"%";
      const p=document.createElement("p");
      p.innerHTML=`${m.month}: Â£${m.total_estimated_income}`;
      divContainer.appendChild(p);
      divContainer.appendChild(b);
    });
  }

  // Upcoming Dividends
  const upcoming = data.dividends_feed.filter(d => d.status && (d.status.includes("Confirmed") || d.status.includes("Estimated"))).slice(0,5);
  const uList=document.getElementById("upcomingList");
  upcoming.forEach(u=>{
    const li=document.createElement("li");
    li.innerHTML=`ðŸ’Ž <strong>${u.name}</strong> â€” Pay: ${u.pay_date} â€” Â£${u.total_dividend}`;
    uList.appendChild(li);
  });

  // Show content
  document.getElementById("loadingScreen").style.display="none";
  document.getElementById("mainContent").style.display="block";
}

loadData();
</script>
</body>
</html>
